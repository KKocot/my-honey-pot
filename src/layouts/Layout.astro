---
import '../styles/global.css'
import { getPayloadClient } from '../lib/payload'

interface Props {
  title: string
}

interface SiteSettings {
  siteTheme?: 'light' | 'dark' | 'green' | 'pink'
  siteName?: string
  siteDescription?: string
}

const { title } = Astro.props

let siteTheme: SiteSettings['siteTheme'] = 'light'

try {
  const payload = await getPayloadClient()
  const settings = await payload.findGlobal({
    slug: 'settings',
  }) as SiteSettings
  siteTheme = settings.siteTheme || 'light'
} catch {
  siteTheme = 'light'
}
---

<!doctype html>
<html lang="pl" data-theme={siteTheme}>
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body class="bg-bg text-text min-h-screen transition-colors duration-300">
    <slot />
  </body>
</html>
