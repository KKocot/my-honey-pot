---
/**
 * BlogLogicPostCard - uses shared PostCard utilities
 * Uses sections-based layout system
 */
import type { Post } from '../../lib/blog-logic'
import type { CardLayout, PostCardSettings } from '../../shared/components/post-card'
import {
  createPostCardDataFromPost,
  renderPostCard,
} from '../../shared/components/post-card'

interface Props {
  post: Post
  thumbnailSizePx: number
  cardPaddingPx: number
  cardBorderRadiusPx: number
  titleSizePx: number
  summaryMaxLength: number
  cardBorder: boolean
  maxTags: number
  masonryStyle?: string
  // Sections layout (required)
  postCardLayout: CardLayout
  // Hover effect settings
  cardHoverEffect?: 'none' | 'shadow' | 'lift' | 'scale' | 'glow'
  cardTransitionDuration?: number
  cardHoverScale?: number
  cardHoverShadow?: string
  cardHoverBrightness?: number
}

const {
  post,
  thumbnailSizePx,
  cardPaddingPx,
  cardBorderRadiusPx,
  titleSizePx,
  summaryMaxLength,
  cardBorder,
  maxTags,
  masonryStyle = '',
  postCardLayout,
  cardHoverEffect,
  cardTransitionDuration,
  cardHoverScale,
  cardHoverShadow,
  cardHoverBrightness,
} = Astro.props

// Create normalized post data using shared utility
const postData = await createPostCardDataFromPost(post, {
  thumbnailSizePx,
  maxTags,
  summaryMaxLength,
})

// Create settings object
const cardSettings: PostCardSettings = {
  thumbnailSizePx,
  cardPaddingPx,
  cardBorderRadiusPx,
  titleSizePx,
  summaryMaxLength,
  maxTags,
  cardBorder,
  postCardLayout,
  cardHoverEffect,
  cardTransitionDuration,
  cardHoverScale,
  cardHoverShadow,
  cardHoverBrightness,
}

// Render using shared function
const postCardHtml = renderPostCard(postData, cardSettings, false, `/${post.permlink}`, masonryStyle)
---

<Fragment set:html={postCardHtml} />
