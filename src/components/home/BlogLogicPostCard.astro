---
/**
 * BlogLogicPostCard - uses shared PostCard utilities
 */
import type { Post } from '../../lib/blog-logic'
import {
  createPostCardDataFromPost,
  createPostCardSettings,
  renderPostCard,
} from '../../shared/components/post-card'

interface Props {
  post: Post
  cardLayout: 'horizontal' | 'vertical'
  thumbnailPosition: 'left' | 'right'
  thumbnailSizePx: number
  cardPaddingPx: number
  cardBorderRadiusPx: number
  titleSizePx: number
  showThumbnail: boolean
  showSummary: boolean
  summaryMaxLength: number
  showDate: boolean
  showVotes: boolean
  showComments: boolean
  showPayout: boolean
  showTags: boolean
  cardBorder: boolean
  maxTags: number
  masonryStyle?: string
}

const {
  post,
  cardLayout,
  thumbnailPosition,
  thumbnailSizePx,
  cardPaddingPx,
  cardBorderRadiusPx,
  titleSizePx,
  showThumbnail,
  showSummary,
  summaryMaxLength,
  showDate,
  showVotes,
  showComments,
  showPayout,
  showTags,
  cardBorder,
  maxTags,
  masonryStyle = ''
} = Astro.props

// Create normalized post data using shared utility
const postData = await createPostCardDataFromPost(post, {
  thumbnailSizePx,
  maxTags,
  summaryMaxLength,
})

// Create settings using shared utility
const cardSettings = createPostCardSettings({
  cardLayout,
  thumbnailPosition,
  thumbnailSizePx,
  cardPaddingPx,
  cardBorderRadiusPx,
  titleSizePx,
  showThumbnail,
  showSummary,
  summaryMaxLength,
  showDate,
  showVotes,
  showComments,
  showPayout,
  showTags,
  cardBorder,
  maxTags,
})

// Render using shared function
const isVertical = cardLayout === 'vertical'
const postCardHtml = renderPostCard(postData, cardSettings, isVertical, `/${post.permlink}`, masonryStyle)
---

<Fragment set:html={postCardHtml} />
