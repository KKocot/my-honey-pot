---
interface Tab {
  id: string
  label: string
  count?: number
}

interface Props {
  tabs: Tab[]
  activeTab: string
  baseUrl?: string
  userParam?: string
}

const { tabs, activeTab, baseUrl = '', userParam } = Astro.props

// Build query string preserving user param
function buildHref(tabId: string): string {
  const params = new URLSearchParams()
  if (userParam) params.set('user', userParam)
  if (tabId !== 'posts') params.set('tab', tabId)
  const query = params.toString()
  return query ? `${baseUrl || '/'}?${query}` : baseUrl || '/'
}
---

<nav class="border-b border-border mb-6">
  <div class="flex">
    {tabs.map(tab => {
      const isActive = tab.id === activeTab
      const href = buildHref(tab.id)

      return (
        <a
          href={href}
          class={`
            relative px-6 py-4 text-sm font-medium transition-colors
            hover:bg-bg-card/50
            ${isActive ? 'text-text' : 'text-text-muted hover:text-text'}
          `}
          data-tab={tab.id}
        >
          <span class="flex items-center gap-2">
            {tab.label}
            {tab.count !== undefined && (
              <span class={`
                text-xs px-1.5 py-0.5 rounded-full
                ${isActive ? 'bg-primary/10 text-primary' : 'bg-bg text-text-muted'}
              `}>
                {tab.count}
              </span>
            )}
          </span>
          {isActive && (
            <span class="absolute bottom-0 left-0 right-0 h-1 bg-primary rounded-t-full" />
          )}
        </a>
      )
    })}
  </div>
</nav>
